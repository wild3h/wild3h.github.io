<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <script src="https://unpkg.com/vue@next"></script>
    <!-- touchIcon -->
    <link rel="apple-touch-icon" sizes="180x180" href="./Èì≤.png">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <!-- import JavaScript -->
    <script src="https://unpkg.com/element-plus"></script>
    <title>ÂÜçÂÜô‰ª£Á†ÅÂ∞±ÈÄÄÁΩë</title>
    <!--ÂºïÂÖ•Êú¨Âú∞xlsx.core.min.js-->
    <script src="xlsx.core.min.js"></script>
    <!--ÂºïÂÖ•Êú¨Âú∞xlsx.full.min.js-->
    <script src="xlsx.full.min.js"></script>
</head>
<style>
    .demo-tabs>.el-tabs__content {
        padding: 32px;
        color: #6b778c;
        font-size: 32px;
        font-weight: 600;
    }

    .el-tabs--right .el-tabs__content,
    .el-tabs--left .el-tabs__content {
        height: 100%;
    }

    .single-line {
        margin-top: 20px;
    }

    .el-link {
        margin-right: 12px;
    }

    .el-link .el-icon--right.el-icon {
        vertical-align: text-bottom;
    }
</style>

<body>
    <div id="app">
        <el-tabs :tab-position="'left'" style="height: 100%" class="demo-tabs">
            <el-tab-pane label="ÊµèËßàÂô®‰∫ëÁ´ØÈÖçÁΩÆÊï∞ÊçÆÊ†ºÂºèÂåñ">
                <div style="overflow: scroll;height: 95%;">
                    <!--ÂàõÂª∫‰∏Ä‰∏™ÈÄâÊã©Êú¨Âú∞Êñá‰ª∂ÁöÑÊåâÈíÆÔºåÁÑ∂ÂêéËØªÂèñËØ•Êñá‰ª∂ÔºåËØ•Êñá‰ª∂ÊòØExcelÔºåËØªÂèñÊØè‰∏ÄË°åÊï∞ÊçÆ-->
                    <el-upload drag ref="upload" class="upload-demo" :limit="1" :on-change="handleExceed"
                        :auto-upload="false" multiple="false">
                        <el-button type="primary">ÈÄâÊã©Êñá‰ª∂/ÊãñÊãΩÊñá‰ª∂Âà∞ËøôÈáå</el-button>
                    </el-upload>
                    <div class="single-line">
                        <el-button @click="copy()">‰∏ÄÈîÆÂ§çÂà∂</el-button>
                        <el-text class="mx-1" size="large">&nbsp;&nbsp;&nbsp;TipsÔºöÊî∂ËóèurlÈÖçÁΩÆÂÆåÊï¥ÂüüÂêçÔºåÈªëÂêçÂçïurl‰ªÖÈÖçhost</el-text>
                    </div>
                    <div class="single-line">
                        <el-button type="primary" @click="downloadBlackList()">ÈªëÂêçÂçï ÈªòËÆ§ÈÖçÁΩÆExcel</el-button>
                        <el-button type="primary" @click="downloadFavorite()">Êî∂Ëóè ÈªòËÆ§ÈÖçÁΩÆExcel</el-button>
                    </div>
                    <div class="single-line">
                        <el-button type="primary" @click="downloadPad()">padÊ®°Âºè ÈªòËÆ§ÈÖçÁΩÆExcel</el-button>
                        <el-button type="primary" @click="downloadMultiTab()">Â§öÊ†áÁ≠æ ÈªòËÆ§ÈÖçÁΩÆExcel</el-button>
                    </div>
                    <div>
                        <el-input id="result" style="width: 500px;height:auto;margin-top: 20px;" v-model="resultText"
                            type="textarea" placeholder="Ëß£ÊûêÁªìÊûú" :autosize="{ minRows:4,maxRows:20}" />
                    </div>
                    <div style="margin-top: 20px;">
                        <el-text class="mx-1" size="large">ÈÖçÁΩÆÂπ≥Âè∞‰º†ÈÄÅÈó®‚Üì‚Üì‚Üì</el-text>
                    </div>
                    <!--Êç¢Ë°åcss-->
                    <div style="margin-top: 20px;">
                        <el-link>
                            <a href="https://crs-configcenter-web.test.k8s.chj.cloud/" target="_blank">Test</a>
                        </el-link>
                        <el-link>
                            <a href="https://crs-configcenter-web.testtwo.k8s.chj.cloud" target="_blank">TestTwo</a>
                        </el-link>
                        <el-link>
                            <a href="https://crs-configcenter-web.ontest.k8s.chj.cloud/" target="_blank">Ontest</a>
                        </el-link>
                        <el-link>
                            <a href="https://crs-configcenter-web.prod.k8s.chj.cloud/" target="_blank">Prod</a>
                        </el-link>
                    </div>
                </div>
            </el-tab-pane>
            <el-tab-pane label="ÊñáÂ®±ÁªÑ‰ª∂ÂåñÂ£≥Â∑•Á®ãÁõ∏ÂÖ≥">
                <div style="overflow: scroll;height: 95%;">
                    <div class="single-line">
                        <el-text class="mx-1" size="large" style="width: 100%;">ÂΩìÂâçÈÖçÁΩÆÂàóË°®Ôºö</el-text>
                    </div>
                    <el-text class="mx-2" size="small">
                        {
                        "repos": [
                        {
                        "repoName": "Èü≥È¢ë",
                        "repo": "git@gitlab.chehejia.com:entertainment/chromium/librowser.git",
                        "repoFolder": "librowser",
                        "type": "music",
                        "module": [
                        {
                        "moduleName": "lib_base",
                        "isNecessary": true
                        },
                        {
                        "moduleName": "lib_protocol",
                        "isNecessary": true
                        },
                        {
                        "moduleName": "lib_data",
                        "isNecessary": true
                        },
                        {
                        "moduleName": "module_home",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_history",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_mine",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_category",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_detail",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_player",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_system",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_voice",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_settings",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_mediabar",
                        "isNecessary": false
                        }
                        ],
                        "style": [
                        {
                        "pic": "style_music_1"
                        },
                        {
                        "pic": "style_music_2"
                        }
                        ]
                        },
                        {
                        "repoName": "ËßÜÈ¢ë",
                        "repo": "git@gitlab.chehejia.com:entertainment/chromium/librowser.git",
                        "repoFolder": "librowser",
                        "type": "video",
                        "module": [
                        {
                        "moduleName": "lib_base",
                        "isNecessary": true
                        },
                        {
                        "moduleName": "lib_protocol",
                        "isNecessary": true
                        },
                        {
                        "moduleName": "module_auth",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_blacklist",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_history",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_media",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_more",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_qrcode",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_safety",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_voice",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_webview",
                        "isNecessary": false
                        },
                        {
                        "moduleName": "module_favorite",
                        "isNecessary": false
                        }
                        ],
                        "style": [
                        {
                        "pic": "style_video_1"
                        },
                        {
                        "pic": "style_video_2"
                        }
                        ]
                        },
                        {
                        "repoName": "ÊúâÂ£∞",
                        "repo": "www.baidu.com",
                        "repoFolder": "librowser",
                        "type": "sound",
                        "module": [
                        {
                        "moduleName": "lib_base",
                        "isNecessary": true
                        }
                        ],
                        "style": [
                        {
                        "pic": "style_sound_1"
                        },
                        {
                        "pic": "style_sound_2"
                        }
                        ]
                        }
                        ]
                        }
                    </el-text>
                    <iframe src="https://www.bejson.com/jsoneditoronline/" frameborder="0"
                        style="width: 100%;height: 100%;"></iframe>
                </div>
            </el-tab-pane>
        </el-tabs>
    </div>

    <script>
        const App = {
            data() {
                return {
                    resultText: "",
                    configText: ""
                };

            },
            methods: {
                copy: function () {
                    let text = this.resultText;
                    //Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø
                    var input = document.createElement('textarea');
                    // ÈöêËóèÊ≠§ËæìÂÖ•Ê°Ü
                    input.style.position = 'absolute';
                    input.style.width = '1px';
                    input.style.height = '1px';
                    input.style.clip = 'rect(0 0 0 0)';
                    document.body.appendChild(input);
                    input.value = text;
                    input.focus();
                    input.select();
                    if (document.execCommand('copy')) {
                        document.execCommand('copy');
                        alert('Â§çÂà∂ÊàêÂäü');
                    }
                },
                handleExceed: function (files) {
                    console.log(files);
                    //Âà§Êñ≠Êñá‰ª∂Á±ªÂûãÔºåÂ¶ÇÊûúÊòØexcelÊñá‰ª∂
                    if (files.name.split(".")[1] == "xlsx" || files.name.split(".")[1] == "xls") {
                        var wb;//ËØªÂèñÂÆåÊàêÁöÑÊï∞ÊçÆ
                        var rABS = true; //ÊòØÂê¶Â∞ÜÊñá‰ª∂ËØªÂèñ‰∏∫‰∫åËøõÂà∂Â≠óÁ¨¶‰∏≤
                        let file = files.raw;
                        var reader = new FileReader();
                        if (rABS) {
                            reader.readAsArrayBuffer(file);
                        } else {
                            reader.readAsBinaryString(file);
                        }
                        var that = this;
                        reader.onload = function (e) {
                            var data = e.target.result;
                            if (rABS) {
                                var o = "",
                                    l = 0,
                                    w = 10240;
                                for (; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)));
                                o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
                                wb = XLSX.read(btoa(o), {//ÊâãÂä®ËΩ¨Âåñ
                                    type: 'base64'
                                });
                            } else {
                                wb = XLSX.read(data, {
                                    type: 'binary'//‰ª•‰∫åËøõÂà∂ÁöÑÊñπÂºèËØªÂèñ
                                });
                            }
                            let text = "{\"list\":" + JSON.stringify(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]])) + "}";
                            //jsonÊ†ºÂºèÂåñ
                            text = JSON.stringify(JSON.parse(text), null, 4).toString();
                            //console.log(text);
                            that.resultText = text;
                        }
                    } else if (files.name.split(".")[1] == "txt") {
                        var reader = new FileReader();
                        reader.readAsText(files.raw, "UTF-8");
                        var that = this;
                        reader.onload = function (e) {
                            let text = e.target.result;
                            console.log(text);
                            //ÈÄêË°åËØªÂèñ
                            let arr = text.split("\n");
                            let result = [];
                            for (let i = 0; i < arr.length; i++) {
                                let obj = {};
                                obj["url"] = arr[i];
                                result.push(obj);
                            }
                            text = "{\"list\":" + JSON.stringify(result) + "}";
                            //jsonÊ†ºÂºèÂåñ
                            text = JSON.stringify(JSON.parse(text), null, 4).toString();
                            console.log(text);
                            that.resultText = text;
                        }
                    } else {
                        alert("ËØ∑‰∏ä‰º†ExcelÊàñËÄÖtxtÊñá‰ª∂");
                    }
                }

            },
            downloadBlackList: function () {
                location.href = "./sampleBlackList.xlsx";
            },
            downloadFavorite: function () {
                location.href = "./sampleFavorite.xlsx";
            },
            downloadPad: function () {
                location.href = "./samplePad.xlsx";
            },
            downloadMultiTab: function () {
                location.href = "./sampleMultiTab.xlsx";
            }
        };
        const app = Vue.createApp(App);
        app.use(ElementPlus);
        app.mount("#app");
        console.log('ü§£üëáü§£\nüëâü§°üëà\nü§£üëÜü§£');



    </script>
</body>

</html>