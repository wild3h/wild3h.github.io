<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <script src="https://unpkg.com/vue@next"></script>
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <!-- import JavaScript -->
    <script src="https://unpkg.com/element-plus"></script>
    <title>å†å†™ä»£ç å°±é€€ç½‘</title>
    <!--å¼•å…¥æœ¬åœ°xlsx.core.min.js-->
    <script src="xlsx.core.min.js"></script>
    <!--å¼•å…¥æœ¬åœ°xlsx.full.min.js-->
    <script src="xlsx.full.min.js"></script>
</head>
<style>
    .demo-tabs>.el-tabs__content {
        padding: 32px;
        color: #6b778c;
        font-size: 32px;
        font-weight: 600;
    }

    .el-tabs--right .el-tabs__content,
    .el-tabs--left .el-tabs__content {
        height: 100%;
    }

    .single-line {
        margin-top: 20px;
    }

    .el-link {
        margin-right: 12px;
    }

    .el-link .el-icon--right.el-icon {
        vertical-align: text-bottom;
    }
</style>

<body>
    <div id="app">
        <el-tabs :tab-position="'left'" style="height: 100%" class="demo-tabs">
            <el-tab-pane label="é»‘åå•æ ¼å¼åŒ–">
                <div>
                    <!--åˆ›å»ºä¸€ä¸ªé€‰æ‹©æœ¬åœ°æ–‡ä»¶çš„æŒ‰é’®ï¼Œç„¶åè¯»å–è¯¥æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯Excelï¼Œè¯»å–æ¯ä¸€è¡Œæ•°æ®-->
                    <el-upload ref="upload" class="upload-demo" :limit="1" :on-change="handleExceed"
                        :auto-upload="false">
                        <el-button type="primary">é€‰æ‹©æ–‡ä»¶</el-button>
                    </el-upload>
                    <div class="single-line">
                        <el-button @click="copy()">ä¸€é”®å¤åˆ¶</el-button>
                        <el-button type="primary" @click="download()">ä¸‹è½½é»˜è®¤é…ç½®Excel</el-button>
                    </div>
                    <div>
                        <el-input id="result" style="width: 500px;height:auto;margin-top: 20px;" v-model="resultText"
                            type="textarea" placeholder="è§£æç»“æœ" :autosize="{ minRows:4,maxRows:20}" />
                    </div>
                    <div style="margin-top: 20px;">
                        <el-text class="mx-1" size="large">é…ç½®å¹³å°ä¼ é€é—¨â†“â†“â†“</el-text>
                    </div>
                    <!--æ¢è¡Œcss-->
                    <div style="margin-top: 20px;">
                        <el-link>
                            <a href="https://crs-configcenter-web.test.k8s.chj.cloud/" target="_blank">Test</a>
                        </el-link>
                        <el-link >
                            <a href="https://crs-configcenter-web.testtwo.k8s.chj.cloud" target="_blank">TestTwo</a>
                        </el-link>
                        <el-link>
                            <a href="https://crs-configcenter-web.ontest.k8s.chj.cloud/" target="_blank">Ontest</a>
                        </el-link>
                        <el-link>
                            <a href="https://crs-configcenter-web.prod.k8s.chj.cloud/" target="_blank">Prod</a>
                        </el-link>
                    </div>
                </div>
            </el-tab-pane>
            <!-- <el-tab-pane label="Config">
                <el-button>Button</el-button>
            </el-tab-pane> -->
        </el-tabs>
    </div>

    <script>
        const App = {
            data() {
                return {
                    resultText: "",
                };

            },
            methods: {
                copy: function () {
                    let text = this.resultText;
                    //å¤åˆ¶åˆ°å‰ªè´´æ¿
                    var input = document.createElement('textarea');
                    // éšè—æ­¤è¾“å…¥æ¡†
                    input.style.position = 'absolute';
                    input.style.width = '1px';
                    input.style.height = '1px';
                    input.style.clip = 'rect(0 0 0 0)';
                    document.body.appendChild(input);
                    input.value = text;
                    input.focus();
                    input.select();
                    if (document.execCommand('copy')) {
                        document.execCommand('copy');
                        alert('å¤åˆ¶æˆåŠŸ');
                    }
                },
                handleExceed: function (files) {
                    var wb;//è¯»å–å®Œæˆçš„æ•°æ®
                    var rABS = true; //æ˜¯å¦å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
                    let file = files.raw;
                    var reader = new FileReader();
                    if (rABS) {
                        reader.readAsArrayBuffer(file);
                    } else {
                        reader.readAsBinaryString(file);
                    }
                    var that = this;
                    reader.onload = function (e) {
                        var data = e.target.result;
                        if (rABS) {
                            var o = "",
                                l = 0,
                                w = 10240;
                            for (; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)));
                            o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
                            wb = XLSX.read(btoa(o), {//æ‰‹åŠ¨è½¬åŒ–
                                type: 'base64'
                            });
                        } else {
                            wb = XLSX.read(data, {
                                type: 'binary'//ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–
                            });
                        }
                        let text = "{\"list\":" + JSON.stringify(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]])) + "}";
                        //jsonæ ¼å¼åŒ–
                        text = JSON.stringify(JSON.parse(text), null, 4).toString();
                        //console.log(text);
                        that.resultText = text;
                    }
                },
                download: function () {
                    location.href = "./sample.xlsx";
                }
            }
        };
        const app = Vue.createApp(App);
        app.use(ElementPlus);
        app.mount("#app");
        console.log('ğŸ¤£ğŸ‘‡ğŸ¤£\nğŸ‘‰ğŸ¤¡ğŸ‘ˆ\nğŸ¤£ğŸ‘†ğŸ¤£');



    </script>
</body>

</html>